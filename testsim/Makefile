#
#--Makefile to remake the executable and copy to this directory
#  Generated by ../scripts/writemake.sh: Fri Feb 27 11:08:20 PM GMT 2026
#
PHANTOMDIR=../
SPLASHDIR=/root/splash
EDITOR=vi
ifndef SETUP
SETUP=disc
endif

again:
	set -e; cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP}; cd -; cp ${PHANTOMDIR}/bin/phantom .; cp ${PHANTOMDIR}/bin/phantom_version .

all: again setup infile

.PHONY: phantom phantomsetup phantom2power phantom2grid phantomanalysis phantomevcompare libphantom mflow
phantom         : again
phantomsetup    : setup
phantom2power   : power
phantom2grid    : grid
phantomanalysis : analysis
phantomevcompare: evcompare
phantomsinks    : sinks
libphantom      : phantomlib
mflow           : mflow

clean:
	cd ${PHANTOMDIR}; make clean
setup:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} setup; cd -; cp ${PHANTOMDIR}/bin/phantomsetup .
moddump:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} moddump; cd -; cp ${PHANTOMDIR}/bin/phantommoddump .
analysis:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} analysis; cd -; cp ${PHANTOMDIR}/bin/phantomanalysis .
phantomlib:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} libphantom; cd -; cp ${PHANTOMDIR}/bin/libphantom.so .
pyanalysis:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} pyanalysis; cd -; cp ${PHANTOMDIR}/bin/libphantom.so .; ${PHANTOMDIR}/scripts/pyphantom/writepyanalysis.sh 
power:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} phantom2power; cd -; cp ${PHANTOMDIR}/bin/phantom2power .
grid:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} phantom2grid; cd -; cp ${PHANTOMDIR}/bin/phantom2grid .
evcompare:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} phantomevcompare; cd -; cp ${PHANTOMDIR}/bin/phantomevcompare .
sinks:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} phantomsinks; cd -; cp ${PHANTOMDIR}/bin/phantomsinks .
mflow:
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} mflow; cd -; cp ${PHANTOMDIR}/bin/mflow .; cp ${PHANTOMDIR}/bin/ev2mdot .; cp ${PHANTOMDIR}/bin/lombperiod .
make:
	cd ${PHANTOMDIR}; ${EDITOR} build/Makefile &
qscript:
	@cd ${PHANTOMDIR}; make --quiet RUNDIR="${PWD}" SETUP=${SETUP} qscript
%::
	cd ${PHANTOMDIR}; make RUNDIR="${PWD}" SETUP=${SETUP} ${MAKECMDGOALS}; if [ -e ${PHANTOMDIR}/bin/$@ ]; then cd -; cp ${PHANTOMDIR}/bin/$@ .; fi
#
# the following are for rebuilding splash
#
plot:
	cd ${SPLASH_DIR}; make sphNG
plotc:
	cd ${SPLASH_DIR}; make clean
